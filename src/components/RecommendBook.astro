---
import { getCollection } from 'astro:content';
import { getPath } from "@/utils/getPath";

const TOPICS = {
  "Trinh thám": ["Crime", "Detective"],
  "Khoa học": ["Science", "Non-fiction"],
  "Tình cảm": ["Romance", "Love"],
};

const topicList = Object.keys(TOPICS);

const posts = await getCollection('blog');

const books = posts.map(post => ({
  title: post.data.title,
  tags: post.data.tags || [],
  description: post.data.description || '',
  href: getPath(post.id, post.filePath), // Sử dụng getPath như component Card
}));
---

<div class="recommend-container">
  <label for="topic-select" class="recommend-label">Chọn chủ đề:</label>
  <select id="topic-select" class="recommend-select">
    <option value="">-- Chọn --</option>
    {topicList.map(topic => (
      <option value={topic}>{topic}</option>
    ))}
  </select>

  <div id="recommend-result"></div>
</div>

<script type="module">
  const books = JSON.parse(`${JSON.stringify(books)}`);
  const TOPICS = JSON.parse(`${JSON.stringify(TOPICS)}`);
  const select = document.getElementById('topic-select');
  const resultDiv = document.getElementById('recommend-result');

  select.addEventListener('change', () => {
    const topic = select.value;
    if (!topic) {
      resultDiv.innerHTML =
